Откроем программу t.exe в дизассемблере (я пользуюсь radare2). При первом рассмотрении видим строки «Test 001» и «Lorem ipsum dolor sit amet». Ищем ссылки на них в программе. Их нет, что как бы намекает, что к MessageBox они не имеют отношения.

0x0040106a  ba40 b874 7581 f232 d900 0052 ba84 ad6e  .@.tu..2...R...n           
0x0040107a  6781 f2c7 c200 0052 89e7 68e8 0300 00ff  g......R..h.....           
0x0040108a  1564 2040 00eb 0c6a 0056 576a 00ff 1590  .d @...j.VWj....           
0x0040109a  2040 006a 00ff 1568 2040 0054 6573 7430   @.j...h @.Test0           
0x004010aa  3031 004c 6f72 656d 2069 7073 756d 2064  01.Lorem ipsum d           
0x004010ba  6f6c 6f72 2073 6974 2061 6d65 7400 0000  olor sit amet...           
0x004010ca  0000 0000 0000 0000 0000 0000 0000 0000  ................

Смотрим дальше и видим, что при передаче в параметры MessageBox (а именно регистры esi, edi) используются данные на стеке, которые были предварительно расшифрованы посредством xor. Это окончательно убеждает, что выше упомянутые строки не причем.

0x0040106a      ba40b87475     mov edx, 0x7574b840                  
0x0040106f      81f232d90000   xor edx, 0xd932                      
0x00401075      52             push edx                             
0x00401076      ba84ad6e67     mov edx, 0x676ead84                  
0x0040107b      81f2c7c20000   xor edx, 0xc2c7                      
0x00401081      52             push edx                             
0x00401082      89e7           mov edi, esp

0x0040108f      eb0c           jmp loc.0040109d            
0x00401091      6a00           push 0                               
0x00401093      56             push esi                             
0x00401094      57             push edi                             
0x00401095      6a00           push 0                               
0x00401097      ff1590204000   call dword [sym.imp.user32.dll_MessageBoxA
;JMP XREF from 0x0040108f (entry0)                              
0x0040109d      6a00           push 0                               
0x0040109f    ff1568204000   call dword [sym.imp.kernel32.dll_ExitProcess

Это приводит к мысли, что чтобы увидеть что же в MessageBox, надо его запустить. Видим, что этому мешает переход на выход из процесса. Таким образом, меняем два байта eb0c на 9090 (nop; nop).

0x0040108f      90             nop                                  
0x00401090      90             nop                                  
0x00401091      6a00           push 0                               
0x00401093      56             push esi                             
0x00401094      57             push edi                             
0x00401095      6a00           push 0                               
0x00401097      ff1590204000   call dword [sym.imp.user32.dll_MessageBoxA

Запускаем измененную программу в винде и видим MessageBox с заголовком «Hello» и текстом «Congratulations, you made it!».

